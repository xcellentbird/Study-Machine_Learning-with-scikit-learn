2021-5-18 ~ 2021-6-4 18ì¼ ë™ì•ˆ ì¹˜ë¤˜ë˜ AI Rush 2021 í•´ì»¤í†¤ì— ëŒ€í•œ ë¦¬ë·°ì…ë‹ˆë‹¤.  
ë°ì´í„°ì™€ ì¼ë¶€ ì‚¬í•­ì— ëŒ€í•´ì„œëŠ” íšŒì‚¬ ê¸°ë°€ì— í•´ë‹¹í•˜ëŠ” ì‚¬í•­ì´ë¼ ì–¸ê¸‰í•  ìˆ˜ ì—†ìŒì„ ë¯¸ë¦¬ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.

# Clova AI Rush 2021
: AI RUSHëŠ” Naver Clovaì—ì„œ ì£¼ìµœí•˜ëŠ” AI ëª¨ë¸ë§ ì±Œë¦°ì§€ì…ë‹ˆë‹¤.



## ì§€ì›ì„œ ì œì¶œ ë° ì°¸ê°€ ì‹ ì²­
![image](https://user-images.githubusercontent.com/59414764/122434428-0e9a3100-cfd2-11eb-8624-6413e4f85a72.png)  

ìœ„ ì¼ì •ì²˜ëŸ¼ ìì†Œì„œ ì„œë¥˜ë¡œ 1ì°¨ ì‹¬ì‚¬ë¥¼ ë³´ê³  2ì°¨ë¡œ ì½”ë”© í…ŒìŠ¤íŠ¸ê°€ ì£¼ì–´ì¡ŒìŠµë‹ˆë‹¤. Kaggleì´ë¼ê³  í•´ë´¤ì, íƒ€ì´íƒ€ë‹‰, ë³´ìŠ¤í„´ ì§‘ê°’ ì˜ˆì¸¡ ê¸°ë³¸ ë¬¸ì œì˜€ê³ , ê·¸ ì™¸ í”„ë¡œì íŠ¸ë¼ê³  í•˜ë”ë¼ë„ YOLOì™€ ê¸°ì´ˆì ì¸ Keras CNN ëª¨ë¸ì„ 
ë§Œë“œëŠ” ê²ƒì´ ì „ë¶€ì˜€ìŠµë‹ˆë‹¤ë§Œ, ìš´ì´ ì¢‹ì•„ ì„œë¥˜ì— ë¶™ì€ ê²ƒ ê°™ì•„ìš”! ê·¸ë¦¬ê³  ì–¼ë§ˆ ì§€ë‚˜ì§€ ì•Šì•„ ì½”ë”©í…ŒìŠ¤íŠ¸ê°€ ì§„í–‰ë˜ì—ˆê³ , ë‚œì´ë„ëŠ” ì¼ë°˜ ê¸°ì—…ì˜ ì½”ë”©í…ŒìŠ¤íŠ¸ë³´ë‹¤ í›¨ì”¬ ì‰¬ì› ìŠµë‹ˆë‹¤~



## ëŒ€íšŒ ì‹œì‘ ì „ ì¤€ë¹„

![image](https://user-images.githubusercontent.com/59414764/122460406-0a2f4180-cfed-11eb-8858-ee2e718b5e99.png)

ì €ëŠ” ì˜ìƒìª½ì— ì§‘ì¤‘í•˜ê³  ì‹¶ì—ˆë˜ í„°ë¼ ë‹¤ë¥¸ ê³ ë¯¼ë„ í•˜ì§€ ì•Šê³  1-3 MYBOX ì´ë¯¸ì§€ ë¶„ë¥˜ ê³¼ì œë¥¼ ì„ íƒí•˜ê²Œ ë˜ì—ˆì–´ìš”. ë‹¤ë¥¸ ê³¼ì œê°€ ë” ê²½ìŸì´ ì‹¬í•˜ì§€ ì•Šì•˜ê³ , ê³¼ì œë¥¼ ë°”ê¿€ ìˆ˜ ìˆì—ˆìŒì—ë„ ë¶ˆêµ¬í•˜ê³ , 
'ë–¨ì–´ì§€ë”ë¼ë„ í•˜ê³  ì‹¶ì€ ê²ƒì— ì§‘ì¤‘í•˜ì'ëŠ” ìƒê°ìœ¼ë¡œ ê³¼ì œë¥¼ ë°”ê¾¸ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. (ë‹¤ë¥¸ ê³¼ì œì— ë¹„í•´ 1.5ë°° ì •ë„ ê²½ìŸì´ ë” ì¹˜ì—´í–ˆì–´ìš” ã… ) ê·¸ë¦¬ê³  ê·¸ë ‡ê²Œ ë§ˆìŒ ë¨¹ì–´ì„œì¸ì§€ ë–¨ì–´ì§€ê³  ë‚˜ì„œ ì§€ê¸ˆê¹Œì§€ë„ í›„íšŒí•˜ì§„ ì•ŠìŠµë‹ˆë‹¤.

ì‹œì‘í•˜ê¸° ì „ì— ì¼ë‹¨ ì‘ë…„ ì°¸ê°€ìë“¤ì˜ ëŒ€íšŒ ë¦¬ë·°ë¥¼ ì‚´í´ë³´ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. Baseline, model ensembleì´ë¼ëŠ” ìš©ì–´ë„ ì²˜ìŒ ë“¤ì–´ë´¤êµ¬ìš”... ì´ì „ ì°¸ê°€ìë¶„ë“¤ì€ ì–´ë– í•œ ì‹¤í—˜ì„ í–ˆê³ , ì–´ë– í•œ ì•„ì‰¬ìš´ ì ì´ ìˆëŠ”ì§€ ì¤‘ì ìœ¼ë¡œ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤.
ì •ë§ í›„ê¸°ë€ í›„ê¸°ëŠ” ë‹¤ ëª¨ì•„ ë¶„ì„í–ˆì–´ìš”. ì–´ë– í•œ ë…¼ë¬¸ì„ ë³´ì…¨ëŠ”ì§€, ì–´ë–¤ ëª¨ë¸, data augmentationì„ ì¼ëŠ”ì§€, ì–´ë– í•œ ê³¼ì •ë¶€í„° ì§„í–‰í•˜ëŠ” ê²Œ ì¢‹ì€ì§€ ë“±ë“±...

ê·¸ë¦¬ê³  Keras CNN ê¸°ì´ˆ ì„œì ('í˜¼ê³µë¨¸ì‹ ')ì„ 3ë²ˆ ì •ë„ ë³µìŠµí–ˆë˜ ê²ƒ ê°™ì•„ìš”. (ê³¼ì œì—ì„œ PyTorchë¥¼ ì¨ì•¼í•œë‹¤ëŠ” ê²ƒì„ ëª¨ë¥¸ ì²´ ë§ì´ì£ ...)



## ëŒ€íšŒ 1ì£¼ì°¨
5.17ì— OTê°€ ì´ì–´ì¡Œê³ , NSMLì— ëŒ€í•´ ì„¤ëª…ì„ ë“¤ì—ˆìŠµë‹ˆë‹¤. í›„ê¸°ì—ì„œëŠ” NSML í™˜ê²½ì— ì ì‘í•˜ëŠ” ê²ƒë„ ì¼ì´ë¼ê³  í–ˆì—ˆëŠ”ë° ê·¸ë¦¬ í˜ë“¤ì§€ëŠ” ì•Šì•˜ë˜ ê²ƒ ê°™ì•„ìš”. ê·¸ë¦¬ê³  Baselineì´ ì£¼ì–´ì¡Œê³ , ì½”ë“œê°€ PyTorchë¼ëŠ” ì‚¬ì‹¤ì„
ì•Œê²Œ ëì£ . ê·¸ë¦¬ê³  PMë‹˜ê»˜ Tensorflow ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ì§€ ì—¬ì­¤ë³´ë‹ˆ... ì‚¬ìš©í•  ìˆ˜ ìˆì§€ë§Œ, ì—¬ëŸ¬ ì´ìœ  ë•Œë¬¸ì— pytorchë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤ê³  ë§ì”€í•˜ì…¨ì£  ã… 

ê·¸ë¦¬ê³  1ì£¼ ë™ì•ˆ Baselineë¥¼ í† ëŒ€ë¡œ pytorch ëª¨ë“ˆì„ ê³µë¶€í•˜ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. tensorflow ì±…ì€ ê¸°ì´ˆë¶€í„° ì‹¬í™”ê¹Œì§€ ë‹¤ì–‘í–ˆì§€ë§Œ, pytorchëŠ” ì±…ì´ ì–¼ë§ˆ ì—†ë”ë¼ê³ ìš”.
ì¼ë‹¨ '3ë¶„ ë”¥ëŸ¬ë‹ íŒŒì´í† ì¹˜ë§›', 'pytorchë¡œ ë°°ìš°ëŠ” ë”¥ëŸ¬ë‹'ìœ¼ë¡œ ê³µë¶€í–ˆìŠµë‹ˆë‹¤. Vision & AI ë‹¨ì²´ ì¹´í†¡ë°©(ì œê°€ ì£¼ë¡œ ì •ë³´ë¥¼ ì–»ëŠ” ê³µê°„ì…ë‹ˆë‹¤)ì—ì„œ Efficientnetì´ ì¢‹ë‹¤ëŠ” ë§ì´ ê¸°ì–µë‚¬ê³ , ì°¾ì•„ë³´ë‹ˆ version 2ê°€ ë‚˜ì™”ê¸¸ë ˆ
ë°”ë¡œ ëª¨ë¸ì„ ê°€ì ¸ë‹¤ ì¼ì£ . ì²˜ìŒ Baselineì„ ëŒë ¸ì„ ë•ŒëŠ” 0.23ì ì´ì—ˆëŠ”ë°, ë°”ë¡œ 0.33ì ìœ¼ë¡œ ì˜¬ëìŠµë‹ˆë‹¤. ë­”ê°€ ë„ˆë¬´ ê±°ì € ë¨¹ëŠ” ê±° ê°™ì•„ ë¶ˆì•ˆí•˜ë”ë¼ê³ ìš”. ì¼ë‹¨ êµìˆ˜ë‹˜ì´ í•­ìƒ ë§ì”€í•˜ì‹œë˜ 'ì•Œê³  ì“°ëŠ” ê²Œ ì¢‹ì•„'ê°€ ë– ì˜¬ëê³ 
ë°”ë¡œ Efficient Netì— ëŒ€í•œ ì •ë³´ë¥¼ ì–»ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. Efficientnet v1ì€ https://www.youtube.com/watch?v=5sXQGH9I2VM ë™ì˜ìƒìœ¼ë¡œ ë¹ ë¥´ê²Œ ì •ë³´ë¥¼ ì–»ê³ , v2ëŠ” ë…¼ë¬¸ ì›ì„œë¥¼ ë³´ë©´ì„œ ë¦¬ë·°í–ˆì£ . ë‚˜ì˜¨ ì§€ ì–¼ë§ˆ ì•ˆëœ
ë”°ëˆí•œ ë…¼ë¬¸ì´ì—ˆì£ . í™•ì‹¤íˆ ìµœì‹  ê¸°ìˆ ì„ ë¨¼ì € ì ‘í•œë‹¤ëŠ” ëŠë‚Œì´ ì–´ë–¤ ëŠë‚Œì¸ì§€ ì•Œ ê²ƒ ê°™ìŠµë‹ˆë‹¤ ã…ã… ê°„ë‹¨í•˜ê²Œ ì¶•ì•½í•˜ìë©´, ê¸°ì¡´ v1ì€ Model Scaling(Width Scaling + Depth Scaling + Resolution Scaling)ì„ í†µí•´
ëª¨ë¸ì˜ FLOPS ëŒ€ë¹„ ì„±ëŠ¥ì„ ì˜¬ë ¸ê³ , v2ëŠ” Progressive Learning(ì´ë¯¸ì§€ë¥¼ í•™ìŠµí•  ë•Œë§ˆë‹¤ ë” í¬ê²Œ ë§Œë“œëŠ” ê²ƒ)ì„ ì‚¬ìš©í•˜ì—¬ í•™ìŠµ ì†ë„ë¥¼ ì¦ê°€ì‹œì¼°ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

ì´ë ‡ê²Œ ê³µë¶€í•˜ë©´ì„œ ResNet, DenseNet, VGG net, model ensemble, data augmentationì— ëŒ€í•´ì„œ ì•Œ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ë˜í•œ Efficient Netì„ ë¶„ì„í•˜ë©´ì„œ BatchNormalization, Siluì— ëŒ€í•´ì„œ ì•Œ ìˆ˜ ìˆê²Œ ë˜ì—ˆì£ .
ê° ê¸°ëŠ¥, ë°©ë²•ë“¤ì´ ì–´ë–¤ ì‹ìœ¼ë¡œ ì‘ë™í•˜ëŠ” ì§€, ê·¸ë¦¬ê³  ì–´ë– í•œ ì„±ê²©ì„ ê°€ì§€ëŠ” ì§€ ìœ„ì£¼ë¡œ ê³µë¶€í–ˆìŠµë‹ˆë‹¤. 

ê·¸ë¦¬ê³ ... ì´ë ‡ê²Œ ê¸°ì´ˆë¶€í„° ê³µë¶€í•˜ë©´ì„œ, ë­”ê°€ ë‚¨ë“¤ë³´ë‹¤ ëŠ¦ê²Œ ì‹œì‘í•˜ëŠ” ê²ƒ ê°™ì•„ ì•„ì‰½ê¸°ë„ í–ˆìŠµë‹ˆë‹¤. 0.7 ë„˜ì€ ì‚¬ëŒë“¤ì´ ìˆ˜ë‘ë£©í–ˆê±°ë“ ìš”.
ê´œíˆ ë¦¬ë” ë³´ë“œë¥¼ ë³´ë©´ ìš°ìš¸í•´ì§€ëŠ” ê²ƒ ê°™ì•„ ì´ë•Œë¶€í„° ì•ˆ ë´¤ë˜ ê²ƒ ê°™ì•„ìš”.



## ëŒ€íšŒ 2ì£¼ì°¨
1ì£¼ì°¨ ë•Œ ë°°ìš´ ì§€ì‹ë“¤ì„ ê°€ì§€ê³  Hierarchical Image Classification ëª¨ë¸ì„ ë§Œë“¤ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ë­”ê°€ ëŒ€ë¶„ë¥˜ë¥¼ ë¨¼ì € í•˜ê³ , ì¤‘ë¶„ë¥˜, ì†Œë¶„ë¥˜ ìˆœì„œëŒ€ë¡œ ë¶„ë¥˜í•˜ë„ë¡ í•˜ë©´ ë˜ì§€ ì•Šì„ê¹Œ ìƒê°í–ˆì—ˆëŠ”ë°, ì—­ì‹œ ì‚¬ëŒë“¤ì€ ìƒê°í•˜ëŠ” ê²Œ ë‹¤ ë˜‘ê°™ì•˜ë˜ ê²ƒ ê°™ì•„ìš”. 'Hierarchical Image Classification'ì„ í‚¤ì›Œë“œë¡œ IEEEì—ì„œ ë…¼ë¬¸ì„ ê²€ìƒ‰í–ˆê³ , HCNN, HD-CNNì„ ì ‘í•  ìˆ˜ ìˆì—ˆì–´ìš”. ê·¸ë¦¬ê³  ì´ë¥¼ í† ëŒ€ë¡œ classifierë¥¼ ì œì‘í•˜ë ¤í–ˆìŠµë‹ˆë‹¤.   

 ê·¸ê²ƒë³´ë‹¤ ë¬¸ì œëŠ” loss functionì´ì—ˆì–´ìš”. í•œ ê°œì˜ labelì„ ë¶„ë¥˜í•˜ëŠ” ë¬¸ì œëŠ” ì ‘í•´ë³¸ ì ì´ ìˆì§€ë§Œ, Multi Label Classificationì€ í•´ë³¸ ì ì´ ì—†ì—ˆê¸° ë•Œë¬¸ì´ì£ . ê·¸ë¦¬ê³  'ëª¨ë‘ì˜ ë”¥ëŸ¬ë‹' ê°•ì˜ë¥¼ ë‹¤ì‹œ ë³µìŠµí•˜ë©´ì„œ ì–´ë–»ê²Œ í•´ê²°í•˜ëŠ” ì§€ ì°¾ê¸° ì‹œì‘í–ˆì–´ìš”. ê·¸ë¦¬ê³  pytorch docsë¥¼ ë’¤ì ¸ë³´ë©°, BCELoss ë˜ëŠ” BCEWithLogitsLossë¥¼ ì“°ë©´ ëœë‹¤ëŠ” ê²ƒì„ ì•Œì•„ë‚´ì—ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  Githubì—ì„œ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì€ ì´ í•¨ìˆ˜ë¥¼ ì–´ë–»ê²Œ ì‚¬ìš©í•˜ëŠ”ì§€ ê²€ìƒ‰í•´ë³´ì•˜ì–´ìš”. 3ì¼ì´ë€ ì‹œê°„ì´ ê±¸ë¦¬ê¸´í–ˆì§€ë§Œ, BCEWithLogitsLossë¥¼ ê²¨ìš°ê²¨ìš° ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆê³ , ì ìˆ˜ë¥¼ 0.46ì ê¹Œì§€ ì˜¬ë¦´ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. 
 ë­”ê°€ ë§ì´ ì´ìƒí–ˆì–´ìš”. ë°ì´í„°ì— ë¬¸ì œê°€ ì—†ê³ , ëª¨ë¸ë§Œ ì˜¬ë°”ë¥´ê²Œ ì“°ë©´ ì¼ë°˜ì ìœ¼ë¡œ ì •í™•ë„ 80% ì´ìƒì€ ë‚˜ì˜¬í…ë° ê·¸ì— ë¹„í•´ì„œ í„°ë¬´ë‹ˆ ì—†ì´ ë‚®ì€ ì ìˆ˜ì˜€ì£ . ë¶„ëª… ì–´ë”˜ê°€ ë¬¸ì œê°€ ìˆì„ ê²ƒì´ë¼ ìƒê°í–ˆìŠµë‹ˆë‹¤. classifierì— softmaxë¥¼ ë„£ê³  ë¹¼ê¸°ë„ í•´ë³´ì•˜ê³ , Baselineì½”ë“œë¡œ ë˜ëŒë ¤ ì½”ë“œë¥¼ ë‹¤ì‹œ ì§œë³´ê¸°ë„ í•˜ì˜€ì–´ìš”. í•´ê²°ë˜ëŠ” ê²ƒì€ ì—†ì—ˆê³ , ë‚¨ì€ 1ì£¼ë™ì•ˆ ì—°êµ¬í•˜ëŠ” ê²ƒì„ í¬ê¸°í•˜ê³  ê·¸ëƒ¥ Epoch 1000ê¹Œì§€ ëŒë ¤ë³´ìëŠ” ìƒê°ì„ í•˜ê¸° ì‹œì‘í–ˆìŠµë‹ˆë‹¤. í•˜ë£¨ë™ì•ˆ í•œ ê²ƒì€ validation datasetì„ ë§Œë“¤ì–´ ê³¼ì í•©ë˜ëŠ” ì§€ë§Œ ì‚´í´ë³¼ ìˆ˜ ìˆëŠ” ì½”ë“œë¥¼ ì§  ê²ƒ ë¿ì´ì—ˆìŠµë‹ˆë‹¤. 



## ëŒ€íšŒ 3ì£¼ì°¨
í¬ê¸°í• ê¹Œ í•˜ë˜ ì™€ì¤‘ì—, Baselineì—ì„œ 3ê³„ì¸µ ë¶„ë¥˜ì— Cross Entropy Loss function 3ê°œê°€ ì„ ì–¸ë˜ì–´ ìˆë˜ ê²Œ ìƒê°ë‚¬ì–´ìš”. (í•˜ì§€ë§Œ Baseline ì½”ë“œì—ì„œ ì‹¤ì œì ìœ¼ë¡œ ê³„ì‚°ì— ì‚¬ìš©ëë˜ ê±´ 1ê°œì˜ loss functionë¿) ì´ì²˜ëŸ¼ 3ê°œì˜ loss functionì„ ì‚¬ìš©í•˜ì—¬ ê°ê° ëŒ€ë¶„ë¥˜, ì¤‘ë¶„ë¥˜, ì†Œë¶„ë¥˜ì— ì¨ë³´ìëŠ” ìƒê°ì„ í•˜ê²Œ ëìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ë”í•´ì„œ 'nothing'(ì•„ë¬´ê²ƒë„ ì•„ë‹˜)ì„ ëœ»í•˜ëŠ” -1 classë„ ì¤‘ë¶„ë¥˜, ì†Œë¶„ë¥˜ ê³„ì¸µì— ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ ë‹¤ì‹œ Githubì™€ pytorch docì„ ì°¸ê³ í•˜ì—¬ ì—°êµ¬í•˜ë©´ì„œ í•˜ë£¨ë¥¼ ë‹¤ ì¨ ì½”ë“œë¥¼ ì™„ì„±í•˜ì˜€ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ì„±ì ì€ ë‹¨ë²ˆì— 0.81ì ì„ ê¸°ë¡í•˜ì˜€ì–´ìš”. (ì•„ì§ê¹Œì§€ë„ ì™œ ê·¸ë ‡ê²Œ ë‹¨ë²ˆì— ì ìˆ˜ê°€ ì˜¬ëë˜ ê²ƒì¸ì§€ ì´í•´í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤...)  

 ê·¸ë¦¬ê³  ë‹¤ì‹œ í¬ë§ì„ í’ˆê³ , ì—°êµ¬ë¥¼ ì¬ê°œí•˜ì˜€ìŠµë‹ˆë‹¤. cross_entorpy_lossì—ì„œ ignore_index ê¸°ëŠ¥ì´ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œì•„ë‚´ì—ˆê³ , 'nothing' classë¥¼ ê³„ì‚°í•˜ì§€ ì•Šë„ë¡ ì ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. (í‰ê°€ ë°©ë²•ì—ì„œëŠ” ì‹¤ì œ -1 classë¥¼ ì–´ë–¤ classë¡œ íŒë‹¨í•˜ì—¬ë„ ê°ì ì´ ë˜ì§€ ì•ŠëŠ” ì›ë¦¬ì˜€ê³ , ì•„ë¬´ê±°ë‚˜ ë¹„ìŠ·í•œ ê²ƒì„ ì°ì–´ ì ìˆ˜ë¥¼ ë†’ì´ë ¤ëŠ” ì „ëµì´ì—ˆìŠµë‹ˆë‹¤) ê·¸ë¦¬ê³  ë°ì´í„°ì˜ class ë¶ˆê· í˜• ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ sklearnì˜ compute_class_weightí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ class weightë¥¼ ê³„ì‚°í•˜ì˜€ê³ , ì´ë¥¼ loss functionì˜ weightì— ì ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  fetureë¥¼ í˜¼í•©í•˜ê±°ë‚˜ filterë¥¼ ì„œë¡œ ë¶™ì´ëŠ” í˜•ì‹ìœ¼ë¡œ model ensembleì„ êµ¬í˜„í•˜ì—¬ ì ìš©í•˜ì˜€ì£ . ê¸°ì¡´ efficientnet v2ì— rexnetì„ ensembleí•˜ì˜€ê³ , FLOPS ì œí•œì„ ì„ ë§ì¶”ê¸° ìœ„í•´ moblienet v3ì™€ ì§ì ‘ ë§Œë“  FCN?(C*224*224 filter, One CNN layer) ëª¨ë¸ê¹Œì§€ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ë‚®ì€ ì„±ëŠ¥ì˜ ëª¨ë¸ì¼ì§€ë¼ë„ ensemble ì„±ëŠ¥ í–¥ìƒì— ë„ì›€ì´ ëœë‹¤ëŠ” ëŒ€í•™ì›ìƒ ë¶„ì˜ íŒì´ í° í˜ì´ ë˜ì—ˆì–´ìš”. (nfnetì„ ì‚¬ìš©í–ˆì„ ë•Œ ì ìˆ˜ê°€ ê°€ì¥ ë†’ì•˜ì§€ë§Œ, ëª¨ë¸ì— FLOPSë¬¸ì œê°€ ìˆì–´ ì‚¬ìš© ê¸ˆì§€ë¥¼ ë‹¹í–ˆì£ ...) ì´ëŸ¬í•œ ê³¼ì •ì„ í†µí•´ ì ìˆ˜ëŠ” 89ì ê¹Œì§€ ë„ë‹¬í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.
 
 ì‹œë„í•œ ê²ƒë“¤ ì¤‘ì— ê°€ì¥ í¬í•œí–ˆë˜ ê²ƒì€ ê³„ì¸µ ë¶„ë¥˜ ìˆœì„œë¥¼ ë°”ê¾¸ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤. ê¸°ì¡´ì—ëŠ” ëŒ€ë¶„ë¥˜ -> ì¤‘ë¶„ë¥˜ -> ì†Œë¶„ë¥˜ ìˆœì„œë¡œ ë¶„ë¥˜ë¥¼ í–ˆì—ˆìŠµë‹ˆë‹¤ë§Œ, ì†Œë¶„ë¥˜ -> ì¤‘ë¶„ë¥˜ -> ëŒ€ë¶„ë¥˜ ìˆœì„œë¡œ ë¶„ë¥˜ë¥¼ í•˜ê²Œ í•´í–ˆì„ ë•Œ ì ìˆ˜ê°€ 0.93ê¹Œì§€ ì˜¬ë¼ê°”ì–´ìš”. ì œ ì˜ˆìƒëŒ€ë¡œë¼ë©´ ëª¨ë¸ì˜ headì—ì„œ ëŒ€ëµì˜ featureë¥¼ ê²°ì •í•˜ê³  ëª¨ë¸ì´ ê¹Šì–´ì§ˆ ìˆ˜ë¡ ì„¸ì„¸í•œ featureë¥¼ ì•Œì•„ë‚´ë„ë¡ í•˜ëŠ” ê²ƒì´ì—ˆì§€ë§Œ, ì™„ì „ ë‹¤ë¥´ê²Œ ì‘ë™í•œ ê²ƒì´ì£ . (ì œê°€ ì‹¤í—˜ ì¤‘ì— ëª¨ë¸ì„ ì›Œë‚™ í¬í•œí•˜ê²Œ ì§œì„œ ê·¸ëŸ° ê²ƒì¼ ìˆ˜ë„ ìˆì„ ê²ƒ ê°™ë„¤ìš”...) ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ìœ¼ë¡œ hyperparameter, data augmentationì„ ì‹¤í—˜í•˜ê³ , cutmixë¥¼ êµ¬í˜„í•˜ì—¬ ì—°êµ¬ë¥¼ ë§ˆë¬´ë¦¬í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ìµœì¢… 0.93324ì ìœ¼ë¡œ ë§ˆë¬´ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.
 
 ì—°êµ¬í•œ ê²ƒ ì¤‘ì— í•œ ê°€ì§€ ì•„ì‰¬ìš´ ê²ƒì´ ìˆë‹¤ë©´, í›„ì— ì‹¤í—˜í•˜ì—¬ ì•Œê²Œ ëœ ê²ƒì¸ë°, cutmixê°€ ê³¼ì í•©ì— ì˜í–¥ì„ ë¯¸ì¹œë‹¤ëŠ” ê²ƒì´ì—ˆì–´ìš”. ì²˜ìŒë¶€í„° cutmixë¥¼ ì ìš©í•˜ëŠ” ê²ƒë³´ë‹¤ lr schedulerë¥¼ ì´ìš©í•˜ì—¬ ì¼ì • epochì— cutmixë¥¼ ì ìš©í•˜ì˜€ì„ ë•Œ ì„±ëŠ¥ì´ ë” ì¢‹ì•„ì§€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ì¤€ì§€ë„ í•™ìŠµ ëª¨ë¸ noisy studentì„ êµ¬í˜„í•´ë³´ì§€ ëª»í•œ ê²Œ ì•„ì‰½ê²Œ ë‹¤ê°€ì˜¤ë„¤ìš”. noise labelì„ ìƒê° ëª»í–ˆë˜ ê²ƒë„ ì•„ì‰½ë„¤ìš”...

 
validation dataset score:  
(valid datasetì˜ lossëŠ” ì˜ëª» ë‚˜ì™”ë„¤ìš”)     
 
 ![image](https://user-images.githubusercontent.com/59414764/122453145-fd0e5480-cfe4-11eb-8890-1be920924aee.png)


 
loss & lr:  
 ![image](https://user-images.githubusercontent.com/59414764/122453054-e405a380-cfe4-11eb-82ae-8ec168d8f693.png)



3ì£¼ì°¨ ì‹¤í—˜ ë‚´ì—­:  
![image](https://user-images.githubusercontent.com/59414764/122453889-ad7c5880-cfe5-11eb-9330-8c8a53118b8c.png)



## ëŒ€íšŒ ê²°ê³¼ ë° í”¼ë“œë°±, ëŠë‚€ì 
ì•„ì‰½ê²Œë„ 0.0046ì  ì°¨ì´ë¡œ 2ë¼ìš´ë“œì— ì§„ì¶œí•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. (1ë“±ì€ 0.9606ì ) ì‹¤í—˜í•´ë³´ì§€ ëª»í•œ ê²ƒì´ ë§ì•„ ë§ì´ ì•„ì‰½ê²Œ ëŠê»´ì§€ë„¤ìš”. PyTorchë¥¼ ì œëŒ€ë¡œ ì´í•´í•˜ê³  ì‹œì‘í–ˆë‹¤ë©´ 1ë“±ì„ í•  ìˆ˜ ìˆì—ˆì„ê¹Œìš”?
0.9333 ì ìˆ˜ê°€ ë†’ì•„ë³´ì´ê¸´ í•˜ì§€ë§Œ, ì‹¤ì œ ëŒ€íšŒì—ì„œëŠ” 0.001ì ë„ ë§¤ìš° í¬ë‹¤ê³  ë“¤ì—ˆìŠµë‹ˆë‹¤. ì•„ì§ ë§ì´ ë¶€ì¡±í•œ ì ìˆ˜ì¼ ì§€ë„ ëª¨ë¥´ê² ë„¤ìš”.
semi-supervised model(noisy student), noise label, auto hyperparameter tuning module, ì œëŒ€ë¡œëœ model ensemble ë“± ì•„ì§ í•´ë³´ì§€ ì•Šì€ ê²ƒì´ ë§ì•„ ë„ˆë¬´ ì•„ì‰½ê²Œ ëŠê»´ì§‘ë‹ˆë‹¤.

ì¡°ê¸ˆì€ ìƒìƒ‰ì„ ë‚´ìë©´(ã…‹ã…‹ã…‹) ì •ë§ 3ì£¼ë™ì•ˆ í•˜ë£¨(ì‰¬ëŠ” ë‚ )ë¥¼ ì œì™¸í•˜ê³ , ì ì‹¬ ì¯¤ì— ì¼ì–´ë‚˜ì„œ í•˜ë£¨ì¢…ì¼ ì±…ìƒì— ì•‰ì•„ ì—°êµ¬í•˜ê³  ì•„ì¹¨ì´ ë˜ë©´ ì ë“¤ê³ ë¥¼ ë°˜ë³µí–ˆìŠµë‹ˆë‹¤. ê²°ê³¼ëŠ” ì•„ì‰½ì§€ë§Œ, í° ë§ˆìŒë¨¹ê³  ë„ì „í•œ ë§Œí¼, ê°’ì§„ ê²½í—˜ì„ ê°€ì ¸ë‹¤ ì¤€ ê³µëª¨ì „ì´ì—ˆìŠµë‹ˆë‹¤. ë¶€ì¡±í•œ ê²ƒì´ ì–´ë–¤ ê²ƒì¸ì§€ ê¹¨ë‹«ê²Œ í•´ì£¼ì—ˆê³ , 'ì¡°ê¸ˆ ë” ê³µë¶€í•˜ë©´ í™•ì‹¤í•˜ê²Œ ì„±ì¥í•  ìˆ˜ ìˆê² êµ¬ë‚˜'ëŠ” ìƒê°ì´ ë“œë„¤ìš”. ë¬´ì—‡ë³´ë‹¤ 'AI ë¶„ì•¼ì—ì„œ ì¼ì„ í•´ë„ ê´œì°®ì„ ê²ƒ ê°™ë‹¤'ëŠ”, ì§ì—…ì— ëŒ€í•œ í™•ì‹ ì´ ë“¤ì—ˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ Kaggle ëŒ€íšŒì—ë„ ì°¸ê°€í•´ë³´ê³  ì‹¶ë„¤ìš”. ê°€ëŠ¥í•˜ë‹¤ë©´ ë‚´ë…„ì— ë‹¤ì‹œ ì°¸ê°€í•´ë³¼ ì˜ˆì •ì…ë‹ˆë‹¤ğŸ”¥

ë¶€ì¡±í–ˆë˜ ì : 
1) PyTorch ëª¨ë“ˆì— ëŒ€í•œ ì´í•´(auto grad, no grad, Variable, Tensor, loss function ë“±) => docsë¥¼ ì²˜ìŒë¶€í„° ê¼¼ê¼¼í•˜ê²Œ ì‚´í´ë³´ë©° ì–´ë– í•œ ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆëŠ”ì§€ ì´í•´í•˜ê³ , ë§ì´ ì“°ì´ëŠ” ê¸°ë³¸ì ì¸ í•¨ìˆ˜ë¥¼ íŒŒì•…í•´ë³´ì.
2) Scikit-learnì˜ ì‘ìš© => ëª¨ë“ˆ ì„¤ëª…ì„œë¥¼ ê¼¼ê¼¼í•˜ê²Œ ì½ì–´ë³´ì
3) ìˆ˜í•™ ë…¼ë¦¬ì  íƒêµ¬ë¥¼ í†µí•œ ëª¨ë¸ ì›ë¦¬ ì´í•´(ëª¨ë¸ê³¼ ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•´ ëŒ€ëµì ìœ¼ë¡œ, ê²½í—˜ì ìœ¼ë¡œ ì„¤ëª…í•  ìˆ˜ ìˆì§€ë§Œ, ë…¼ë¦¬ì ìœ¼ë¡œ ê¹Šê²Œ ì›ë¦¬ë¥¼ ì„¤ëª…í•  ìˆ˜ê°€ ì—†ë‹¤ëŠ” ì ) => 'ë°‘ë°”ë‹¥ë¶€í„° ë°°ìš°ëŠ” ë”¥ëŸ¬ë‹' 1ê¶Œ, 3ê¶Œ êµì¬ë¥¼ í†µí•˜ì—¬ ê³µë¶€
4) ëª¨ë¸ë§ ê²½í—˜ => ì»¤ë®¤ë‹ˆí‹°ë¥¼ í†µí•´ ë…¼ë¬¸ê³¼ Tipì„ ì ‘í•˜ê³  ê¸°ë¡í•˜ì

+) ëŒ€íšŒê°€ ì•„ì‰¬ì› ë˜ ì ì€... DMì„ í†µí•´ Naver AI í˜„ì—… ê°œë°œìì™€ êµë¥˜í•  ìˆ˜ ìˆë‹¤ëŠ” ë‚´ìš©ë„ ìˆì—ˆì§€ë§Œ, ë§‰ìƒ PMë‹˜ë“¤ê»˜ ë©”ì„¸ì§€ë¥¼ ë³´ëƒˆì„ ë•Œ, ë°”ì˜ì…¨ë˜ ê±´ì§€... ë©”ì„¸ì§€ë¥¼ ë³´ì§€ ì•Šê±°ë‚˜, 3~5ì¼ í›„ì— ë‹µì¥ì´ ì˜¨ë‹¤ëŠ” ì ì´ ì •ë§ ì•„ì‰¬ì› ìŠµë‹ˆë‹¤...



### ì°¸ê³  ë…¼ë¬¸
[1] Convolutional Network Model using Hierarchical Prediction and its Application in Clothing Image Classification  
[2] CutMix: Regularization Strategy to Train Strong Classifiers with Localizable Features  
[3] EfficientNetV2: Smaller Models and Faster Training  
[4] ImageNet: A Large-Scale Hierarchical Image Database  
[5] Size Matters  
[6] Meta Pseudo Labels  
[7] High-Performance Large-Scale Image Recognition Without Normalization  
[8] An overview of gradient descent optimization algorithms  
[9] SELF: LEARNING TO FILTER NOISY LABELS WITH SELF-ENSEMBLING  
[10] VERY DEEP CONVOLUTIONAL NETWORKS FOR LARGE-SCALE IMAGE RECOGNITION  
[11] HD-CNN: Hierarchical Deep Convolutional Neural Networks for Large Scale Visual Recognition  
[12] íš¨ìœ¨ì ì¸ ì‚¬ë¬¼ ì´ë¯¸ì§€ ë¶„ë¥˜ë¥¼ ìœ„í•œ ê³„ì¸µì  ì´ë¯¸ì§€ ë¶„ë¥˜ ì²´ê³„ì˜ ì„¤ê³„ ë° êµ¬í˜„  
[13] Self-training with Noisy Student improves ImageNet classification  
[14] ReXNet: Diminishing Representational Bottleneck on Convolutional Neural Network  
[15] Searching for MobileNetV3  

